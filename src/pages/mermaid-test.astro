---
/**
 * Mermaid 流程圖測試頁面
 * 用於測試 Mermaid 功能是否正常運作
 */

import BaseLayout from '../layouts/BaseLayout.astro';

const pageTitle = 'Mermaid 流程圖測試';
const pageDescription = '測試 Mermaid 流程圖功能的頁面';
const locale = 'zh-TW';
---

<BaseLayout 
  title={pageTitle}
  description={pageDescription}
  locale={locale}
  pageType="education"
  medicalContent={true}
>
  <div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-8 text-center">
      Mermaid 流程圖測試
    </h1>
    
    <!-- 測試 1: 基本流程圖 -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">
        1. 基本流程圖 - 醫療診斷流程
      </h2>
      <div class="bg-white p-6 rounded-lg border border-gray-200">
        <pre><code class="language-mermaid">{`flowchart TD
    A[患者就診] --> B{症狀評估}
    B -->|發燒| C[測量體溫]
    B -->|咳嗽| D[聽診檢查]
    B -->|胸痛| E[心電圖檢查]
    C --> F[血液檢查]
    D --> G[胸部X光]
    E --> H[心臟超音波]
    F --> I{診斷結果}
    G --> I
    H --> I
    I -->|感染| J[抗生素治療]
    I -->|病毒感染| K[症狀治療]
    I -->|心臟問題| L[轉診心臟科]
    J --> M[追蹤治療]
    K --> M
    L --> N[專科治療]`}</code></pre>
      </div>
    </section>

    <!-- 測試 2: 序列圖 -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">
        2. 序列圖 - 醫療會診流程
      </h2>
      <div class="bg-white p-6 rounded-lg border border-gray-200">
        <pre><code class="language-mermaid">{`sequenceDiagram
    participant P as 患者
    participant GP as 家醫科醫師
    participant S as 專科醫師
    participant L as 檢驗科
    
    P->>GP: 症狀描述
    GP->>P: 初步檢查
    GP->>L: 開立檢驗單
    L->>GP: 檢驗結果
    GP->>S: 轉診申請
    S->>P: 專科診察
    S->>GP: 診斷報告
    GP->>P: 治療計劃說明`}</code></pre>
      </div>
    </section>

    <!-- 測試 3: 甘特圖 -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">
        3. 甘特圖 - 治療計劃時程
      </h2>
      <div class="bg-white p-6 rounded-lg border border-gray-200">
        <pre><code class="language-mermaid">{`gantt
    title 患者治療計劃時程表
    dateFormat  YYYY-MM-DD
    section 診斷階段
    初診評估           :done,    des1, 2024-01-01,2024-01-02
    血液檢查           :done,    des2, 2024-01-02, 2024-01-03
    影像檢查           :done,    des3, 2024-01-03, 2024-01-04
    section 治療階段
    藥物治療           :active,  des4, 2024-01-05, 2024-01-19
    物理治療           :         des5, 2024-01-10, 2024-01-24
    section 追蹤階段
    第一次追蹤        :         des6, 2024-01-20, 2024-01-21
    第二次追蹤        :         des7, 2024-02-05, 2024-02-06
    療效評估           :         des8, 2024-02-20, 2024-02-21`}</code></pre>
      </div>
    </section>

    <!-- 測試 4: 狀態圖 -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">
        4. 狀態圖 - 病患狀態轉換
      </h2>
      <div class="bg-white p-6 rounded-lg border border-gray-200">
        <pre><code class="language-mermaid">{`stateDiagram-v2
    [*] --> 健康
    健康 --> 症狀出現 : 發病
    症狀出現 --> 就醫 : 尋求醫療
    就醫 --> 診斷中 : 接受檢查
    診斷中 --> 確診 : 診斷確立
    確診 --> 治療中 : 開始治療
    治療中 --> 康復 : 治療成功
    治療中 --> 病情惡化 : 治療無效
    病情惡化 --> 調整治療 : 更換療法
    調整治療 --> 治療中 : 繼續治療
    康復 --> 追蹤 : 定期檢查
    追蹤 --> 健康 : 完全康復
    追蹤 --> 復發 : 病情復發
    復發 --> 就醫 : 再次就醫`}</code></pre>
      </div>
    </section>

    <!-- 測試 5: 圓餅圖 -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">
        5. 圓餅圖 - 疾病分布統計
      </h2>
      <div class="bg-white p-6 rounded-lg border border-gray-200">
        <pre><code class="language-mermaid">{`pie title 門診疾病分布統計
    "感冒" : 35
    "高血壓" : 25
    "糖尿病" : 20
    "心臟病" : 10
    "其他" : 10`}</code></pre>
      </div>
    </section>

    <!-- 使用說明 -->
    <section class="bg-blue-50 p-6 rounded-lg">
      <h2 class="text-2xl font-semibold text-blue-800 mb-4">
        📋 使用說明
      </h2>
      <div class="text-blue-700 space-y-2">
        <p><strong>如何在文章中使用 Mermaid 流程圖：</strong></p>
        <ol class="list-decimal list-inside space-y-1 ml-4">
          <li>在 Markdown 編輯器中，使用三個反引號開始程式碼區塊</li>
          <li>在反引號後面加上 <code class="bg-blue-100 px-1 rounded">mermaid</code></li>
          <li>輸入您的 Mermaid 語法</li>
          <li>用三個反引號結束程式碼區塊</li>
          <li>儲存後，系統會自動將語法轉換為視覺化圖表</li>
        </ol>
        <p class="mt-4"><strong>支援的圖表類型：</strong></p>
        <ul class="list-disc list-inside space-y-1 ml-4">
          <li>流程圖 (flowchart)</li>
          <li>序列圖 (sequenceDiagram)</li>
          <li>甘特圖 (gantt)</li>
          <li>狀態圖 (stateDiagram)</li>
          <li>圓餅圖 (pie)</li>
          <li>類別圖 (classDiagram)</li>
          <li>實體關係圖 (erDiagram)</li>
        </ul>
      </div>
    </section>
  </div>
</BaseLayout>

<style>
  /* 自定義 Mermaid 圖表樣式 */
  :global(.mermaid-diagram) {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }
  
  :global(.mermaid-diagram svg) {
    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1));
  }
  
  /* 響應式設計 */
  @media (max-width: 768px) {
    :global(.mermaid-diagram) {
      margin: 1rem 0;
      padding: 0.5rem;
    }
  }
</style>