---
import BaseLayout from '../layouts/BaseLayout.astro';
import ProcedureExplanationSystem from '../components/islands/ProcedureExplanationSystem.tsx';
import proceduresData from '../content/procedures/sample-procedures.json';

const title = 'Medical Procedure Explanation System Demo';
const description = 'Interactive medical procedure explanation system with detailed information, risk visualization, and procedure comparison';

// Get locale from URL or default to 'en'
const locale = Astro.url.searchParams.get('lang') || 'en';
---

<BaseLayout title={title} description={description}>
  <main class="container mx-auto px-4 py-8">
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-gray-900 mb-4">
        {locale === 'zh' ? '醫療程序說明系統演示' : 
         locale === 'ja' ? '医療手順説明システムデモ' : 
         'Medical Procedure Explanation System Demo'}
      </h1>
      <p class="text-lg text-gray-600 max-w-3xl">
        {locale === 'zh' ? 
          '這是一個互動式醫療程序說明系統，提供詳細的程序資訊、風險視覺化和程序比較功能。醫療專業人員可以向患者清楚解釋各種醫療程序，包括準備工作、程序步驟、風險和術後護理。' :
         locale === 'ja' ? 
          'これは、詳細な手順情報、リスクの可視化、手順比較機能を提供するインタラクティブな医療手順説明システムです。医療従事者は、準備、手順ステップ、リスク、アフターケアを含む様々な医療手順を患者に明確に説明できます。' :
          'This is an interactive medical procedure explanation system that provides detailed procedure information, risk visualization, and procedure comparison features. Healthcare professionals can clearly explain various medical procedures to patients, including preparation, procedure steps, risks, and aftercare.'}
      </p>
    </div>

    <div class="mb-8">
      <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg">
        <div class="flex">
          <div class="flex-shrink-0">
            <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
            </svg>
          </div>
          <div class="ml-3">
            <p class="text-sm text-yellow-700">
              {locale === 'zh' ? 
                '注意：此為演示系統，僅供教育和展示用途。實際醫療決策前請諮詢醫療專業人員。' :
               locale === 'ja' ? 
                '注意：これはデモシステムであり、教育および展示目的のみです。実際の医療決定前に医療従事者にご相談ください。' :
                'Note: This is a demonstration system for educational and showcase purposes only. Please consult healthcare professionals before actual medical decisions.'}
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="mb-8">
      <h2 class="text-2xl font-semibold text-gray-900 mb-4">
        {locale === 'zh' ? '功能特色' : 
         locale === 'ja' ? '機能の特徴' : 
         'Key Features'}
      </h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="bg-white p-6 rounded-lg shadow-md">
          <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-2">
            {locale === 'zh' ? '詳細程序說明' : 
             locale === 'ja' ? '詳細な手順説明' : 
             'Detailed Procedure Explanation'}
          </h3>
          <p class="text-gray-600 text-sm">
            {locale === 'zh' ? '包含準備工作、程序步驟、風險評估和術後護理的完整說明' : 
             locale === 'ja' ? '準備、手順ステップ、リスク評価、アフターケアの完全な説明を含む' : 
             'Complete explanations including preparation, procedure steps, risk assessment, and aftercare'}
          </p>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-md">
          <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-2">
            {locale === 'zh' ? '風險視覺化' : 
             locale === 'ja' ? 'リスクの可視化' : 
             'Risk Visualization'}
          </h3>
          <p class="text-gray-600 text-sm">
            {locale === 'zh' ? '清楚展示程序風險，包括發生機率和嚴重程度的視覺化呈現' : 
             locale === 'ja' ? '発生確率と重症度の視覚的表現を含む手順リスクの明確な表示' : 
             'Clear display of procedure risks with visual representation of probability and severity'}
          </p>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-md">
          <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-2">
            {locale === 'zh' ? '程序比較' : 
             locale === 'ja' ? '手順比較' : 
             'Procedure Comparison'}
          </h3>
          <p class="text-gray-600 text-sm">
            {locale === 'zh' ? '並排比較不同程序的持續時間、風險、優點和費用' : 
             locale === 'ja' ? '異なる手順の所要時間、リスク、利点、費用を並べて比較' : 
             'Side-by-side comparison of different procedures\' duration, risks, benefits, and costs'}
          </p>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-md">
          <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-2">
            {locale === 'zh' ? '時間軸說明' : 
             locale === 'ja' ? 'タイムライン説明' : 
             'Timeline Explanation'}
          </h3>
          <p class="text-gray-600 text-sm">
            {locale === 'zh' ? '從準備到完全恢復的完整時間軸，包括每個階段的注意事項' : 
             locale === 'ja' ? '準備から完全回復までの完全なタイムライン、各段階の注意事項を含む' : 
             'Complete timeline from preparation to full recovery, including precautions for each stage'}
          </p>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-md">
          <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-2">
            {locale === 'zh' ? '多語言支援' : 
             locale === 'ja' ? '多言語サポート' : 
             'Multi-language Support'}
          </h3>
          <p class="text-gray-600 text-sm">
            {locale === 'zh' ? '支援繁體中文、日文和英文介面，適合不同語言背景的患者' : 
             locale === 'ja' ? '繁体字中国語、日本語、英語のインターフェースをサポート、異なる言語背景の患者に適用' : 
             'Supports Traditional Chinese, Japanese, and English interfaces for patients with different language backgrounds'}
          </p>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-md">
          <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-2">
            {locale === 'zh' ? '專業認證' : 
             locale === 'ja' ? '専門認定' : 
             'Professional Certified'}
          </h3>
          <p class="text-gray-600 text-sm">
            {locale === 'zh' ? '所有程序說明均經過專科醫師審核，確保資訊準確性和專業性' : 
             locale === 'ja' ? 'すべての手順説明は専門医によって審査され、情報の正確性と専門性を保証' : 
             'All procedure explanations are reviewed by specialist physicians to ensure accuracy and professionalism'}
          </p>
        </div>
      </div>
    </div>

    <!-- Language Switcher -->
    <div class="mb-6">
      <div class="flex gap-2">
        <a 
          href="?lang=en" 
          class={`px-3 py-2 rounded-md text-sm font-medium ${locale === 'en' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
        >
          English
        </a>
        <a 
          href="?lang=zh" 
          class={`px-3 py-2 rounded-md text-sm font-medium ${locale === 'zh' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
        >
          繁體中文
        </a>
        <a 
          href="?lang=ja" 
          class={`px-3 py-2 rounded-md text-sm font-medium ${locale === 'ja' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
        >
          日本語
        </a>
      </div>
    </div>

    <!-- Procedure Explanation System Component -->
    <ProcedureExplanationSystem 
      procedures={proceduresData} 
      locale={locale}
      client:load
    />

    <!-- Usage Instructions -->
    <div class="mt-12 bg-gray-50 rounded-lg p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">
        {locale === 'zh' ? '使用說明' : 
         locale === 'ja' ? '使用方法' : 
         'How to Use'}
      </h2>
      <div class="grid md:grid-cols-2 gap-6">
        <div>
          <h3 class="font-medium text-gray-900 mb-2">
            {locale === 'zh' ? '瀏覽程序' : 
             locale === 'ja' ? '手順を閲覧' : 
             'Browse Procedures'}
          </h3>
          <ul class="text-sm text-gray-600 space-y-1">
            <li>• {locale === 'zh' ? '使用搜尋框輸入程序名稱或關鍵字' : 
                    locale === 'ja' ? '検索ボックスに手順名またはキーワードを入力' : 
                    'Use the search box to enter procedure names or keywords'}</li>
            <li>• {locale === 'zh' ? '按分類或專科篩選程序' : 
                    locale === 'ja' ? 'カテゴリーまたは専門科で手順をフィルタリング' : 
                    'Filter procedures by category or specialty'}</li>
            <li>• {locale === 'zh' ? '按名稱、分類或持續時間排序結果' : 
                    locale === 'ja' ? '名前、カテゴリー、または所要時間で結果をソート' : 
                    'Sort results by name, category, or duration'}</li>
          </ul>
        </div>
        <div>
          <h3 class="font-medium text-gray-900 mb-2">
            {locale === 'zh' ? '詳細說明' : 
             locale === 'ja' ? '詳細説明' : 
             'Detailed Explanation'}
          </h3>
          <ul class="text-sm text-gray-600 space-y-1">
            <li>• {locale === 'zh' ? '點擊「詳細說明」查看完整程序資訊' : 
                    locale === 'ja' ? '「詳細説明」をクリックして完全な手順情報を表示' : 
                    'Click "View Details" to see complete procedure information'}</li>
            <li>• {locale === 'zh' ? '使用標籤頁瀏覽不同資訊類別' : 
                    locale === 'ja' ? 'タブを使用して異なる情報カテゴリーを閲覧' : 
                    'Use tabs to browse different information categories'}</li>
            <li>• {locale === 'zh' ? '查看風險評估和術後護理指導' : 
                    locale === 'ja' ? 'リスク評価とアフターケアガイダンスを確認' : 
                    'Review risk assessment and aftercare guidance'}</li>
          </ul>
        </div>
      </div>
    </div>
  </main>
</BaseLayout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>