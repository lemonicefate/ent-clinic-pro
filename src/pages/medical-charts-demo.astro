---
/**
 * 醫療圖表示例頁面
 * 展示各種醫療數據視覺化組件
 */

import BaseLayout from '../layouts/BaseLayout.astro';
import { 
  RiskAssessmentChart,
  VitalSignsTrend,
  MedicationComparison,
  SymptomSeverityRadar,
  TreatmentEffectivenessScatter
} from '../components/islands/MedicalCharts.tsx';

const locale = 'zh-TW';

// 示例數據
const riskData = {
  low: 45,
  moderate: 30,
  high: 20,
  critical: 5
};

const vitalSignsData = {
  timestamps: ['08:00', '10:00', '12:00', '14:00', '16:00', '18:00'],
  bloodPressureSystolic: [120, 125, 130, 128, 122, 118],
  bloodPressureDiastolic: [80, 82, 85, 83, 78, 75],
  heartRate: [72, 75, 78, 80, 74, 70],
  temperature: [36.5, 36.7, 37.0, 36.8, 36.6, 36.4],
  oxygenSaturation: [98, 97, 96, 97, 98, 99]
};

const medicationData = {
  medications: ['藥物A', '藥物B', '藥物C', '藥物D'],
  effectiveness: [8, 7, 9, 6],
  sideEffects: [3, 5, 2, 7],
  cost: [6, 4, 8, 3]
};

const symptomData = {
  symptoms: ['疼痛', '疲勞', '噁心', '頭暈', '失眠', '食慾不振'],
  severity: [7, 5, 3, 4, 6, 2],
  maxSeverity: 10
};

const treatmentData = {
  treatments: [
    { name: '手術治療', effectiveness: 9, sideEffects: 6, cost: 9 },
    { name: '藥物治療', effectiveness: 7, sideEffects: 3, cost: 4 },
    { name: '物理治療', effectiveness: 6, sideEffects: 1, cost: 3 },
    { name: '放射治療', effectiveness: 8, sideEffects: 7, cost: 8 },
    { name: '免疫治療', effectiveness: 7, sideEffects: 4, cost: 7 }
  ]
};
---

<BaseLayout 
  title="醫療數據視覺化示例"
  description="展示各種醫療圖表組件的功能和用法"
  locale={locale}
>
  <main class="container mx-auto px-4 py-8">
    <!-- 頁面標題 -->
    <div class="text-center mb-12">
      <h1 class="text-3xl font-bold text-medical-neutral-900 mb-4">
        醫療數據視覺化組件
      </h1>
      <p class="text-lg text-medical-neutral-600 max-w-3xl mx-auto">
        專為醫療數據設計的互動式圖表組件，支援風險評估、生命徵象監測、藥物比較等多種醫療場景。
      </p>
    </div>

    <!-- 圖表展示區域 -->
    <div class="space-y-12">
      
      <!-- 風險評估圓餅圖 -->
      <section class="bg-white rounded-lg shadow-sm border border-medical-neutral-200 p-6">
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-medical-neutral-900 mb-2">
            風險評估分布圖
          </h2>
          <p class="text-medical-neutral-600">
            使用圓餅圖展示患者風險等級分布，適用於人群健康管理和風險分層。
          </p>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div>
            <RiskAssessmentChart 
              data={riskData}
              locale={locale}
              title="患者風險分布"
              showPercentages={true}
              height={300}
              client:load
            />
          </div>
          
          <div class="flex flex-col justify-center">
            <h3 class="font-medium text-medical-neutral-900 mb-4">數據解讀</h3>
            <div class="space-y-3">
              <div class="flex items-center">
                <div class="w-4 h-4 bg-green-500 rounded-full mr-3"></div>
                <span class="text-sm">低風險患者佔 45%，建議定期追蹤</span>
              </div>
              <div class="flex items-center">
                <div class="w-4 h-4 bg-yellow-500 rounded-full mr-3"></div>
                <span class="text-sm">中等風險患者佔 30%，需要密切監測</span>
              </div>
              <div class="flex items-center">
                <div class="w-4 h-4 bg-orange-500 rounded-full mr-3"></div>
                <span class="text-sm">高風險患者佔 20%，需要積極干預</span>
              </div>
              <div class="flex items-center">
                <div class="w-4 h-4 bg-red-500 rounded-full mr-3"></div>
                <span class="text-sm">極高風險患者佔 5%，需要緊急處理</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 生命徵象趨勢圖 -->
      <section class="bg-white rounded-lg shadow-sm border border-medical-neutral-200 p-6">
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-medical-neutral-900 mb-2">
            生命徵象監測趨勢
          </h2>
          <p class="text-medical-neutral-600">
            多軸線圖展示患者生命徵象變化趨勢，支援血壓、心率、體溫、血氧飽和度等指標。
          </p>
        </div>
        
        <VitalSignsTrend 
          data={vitalSignsData}
          locale={locale}
          title="患者生命徵象 24 小時監測"
          showGrid={true}
          height={400}
          client:load
        />
        
        <div class="mt-4 p-4 bg-medical-primary-50 rounded-lg">
          <h3 class="font-medium text-medical-primary-900 mb-2">監測要點</h3>
          <ul class="text-sm text-medical-primary-700 space-y-1">
            <li>• 血壓在正常範圍內，略有波動</li>
            <li>• 心率穩定，無明顯異常</li>
            <li>• 體溫在 12:00 時略有升高，需持續觀察</li>
            <li>• 血氧飽和度維持在正常水平</li>
          </ul>
        </div>
      </section>

      <!-- 藥物比較圖表 */
      <section class="bg-white rounded-lg shadow-sm border border-medical-neutral-200 p-6">
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-medical-neutral-900 mb-2">
            藥物療效比較分析
          </h2>
          <p class="text-medical-neutral-600">
            柱狀圖比較不同藥物的療效、副作用和成本，協助臨床決策制定。
          </p>
        </div>
        
        <MedicationComparison 
          data={medicationData}
          locale={locale}
          title="抗高血壓藥物比較"
          showLegend={true}
          height={400}
          client:load
        />
        
        <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="p-4 bg-green-50 rounded-lg">
            <h3 class="font-medium text-green-900 mb-2">推薦藥物</h3>
            <p class="text-sm text-green-700">
              藥物C 具有最佳的療效/副作用比，建議作為首選治療方案。
            </p>
          </div>
          <div class="p-4 bg-yellow-50 rounded-lg">
            <h3 class="font-medium text-yellow-900 mb-2">注意事項</h3>
            <p class="text-sm text-yellow-700">
              藥物D 副作用較多，需要密切監測患者反應。
            </p>
          </div>
        </div>
      </section>

      <!-- 症狀嚴重程度雷達圖 */
      <section class="bg-white rounded-lg shadow-sm border border-medical-neutral-200 p-6">
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-medical-neutral-900 mb-2">
            症狀嚴重程度評估
          </h2>
          <p class="text-medical-neutral-600">
            雷達圖直觀展示患者多維度症狀嚴重程度，便於整體評估和追蹤。
          </p>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div>
            <SymptomSeverityRadar 
              data={symptomData}
              locale={locale}
              title="患者症狀評估 (1-10 分)"
              showScale={true}
              height={400}
              client:load
            />
          </div>
          
          <div class="flex flex-col justify-center">
            <h3 class="font-medium text-medical-neutral-900 mb-4">症狀分析</h3>
            <div class="space-y-3">
              <div class="flex justify-between items-center p-2 bg-red-50 rounded">
                <span class="text-sm font-medium">疼痛</span>
                <span class="text-sm text-red-600">7/10 (嚴重)</span>
              </div>
              <div class="flex justify-between items-center p-2 bg-yellow-50 rounded">
                <span class="text-sm font-medium">失眠</span>
                <span class="text-sm text-yellow-600">6/10 (中等)</span>
              </div>
              <div class="flex justify-between items-center p-2 bg-yellow-50 rounded">
                <span class="text-sm font-medium">疲勞</span>
                <span class="text-sm text-yellow-600">5/10 (中等)</span>
              </div>
              <div class="flex justify-between items-center p-2 bg-green-50 rounded">
                <span class="text-sm font-medium">食慾不振</span>
                <span class="text-sm text-green-600">2/10 (輕微)</span>
              </div>
            </div>
            
            <div class="mt-4 p-3 bg-medical-warning-50 rounded-lg">
              <p class="text-sm text-medical-warning-700">
                <strong>建議：</strong>疼痛和失眠症狀較為嚴重，建議優先處理這兩項症狀。
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- 治療效果散點圖 -->
      <section class="bg-white rounded-lg shadow-sm border border-medical-neutral-200 p-6">
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-medical-neutral-900 mb-2">
            治療方案效果分析
          </h2>
          <p class="text-medical-neutral-600">
            散點圖展示不同治療方案在療效、副作用和成本之間的關係，氣泡大小代表成本高低。
          </p>
        </div>
        
        <TreatmentEffectivenessScatter 
          data={treatmentData}
          locale={locale}
          title="治療方案比較 (療效 vs 副作用)"
          xAxis="effectiveness"
          yAxis="sideEffects"
          height={400}
          client:load
        />
        
        <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="p-4 bg-blue-50 rounded-lg">
            <h3 class="font-medium text-blue-900 mb-2">最佳療效</h3>
            <p class="text-sm text-blue-700">
              手術治療具有最高療效 (9/10)，但副作用和成本也較高。
            </p>
          </div>
          <div class="p-4 bg-green-50 rounded-lg">
            <h3 class="font-medium text-green-900 mb-2">最佳平衡</h3>
            <p class="text-sm text-green-700">
              藥物治療在療效、副作用和成本之間達到較好平衡。
            </p>
          </div>
          <div class="p-4 bg-purple-50 rounded-lg">
            <h3 class="font-medium text-purple-900 mb-2">最低風險</h3>
            <p class="text-sm text-purple-700">
              物理治療副作用最小，成本最低，適合輕症患者。
            </p>
          </div>
        </div>
      </section>

    </div>

    <!-- 使用說明 -->
    <section class="mt-12 bg-medical-primary-50 rounded-lg p-6">
      <h2 class="text-xl font-semibold text-medical-primary-900 mb-4">
        組件特色
      </h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="bg-white rounded-lg p-4">
          <div class="w-8 h-8 bg-medical-primary-600 text-white rounded-lg flex items-center justify-center mb-3">
            📊
          </div>
          <h3 class="font-medium text-medical-neutral-900 mb-2">專業醫療設計</h3>
          <p class="text-sm text-medical-neutral-600">
            針對醫療數據特點設計，使用醫療專業的顏色配置和視覺元素。
          </p>
        </div>
        
        <div class="bg-white rounded-lg p-4">
          <div class="w-8 h-8 bg-medical-primary-600 text-white rounded-lg flex items-center justify-center mb-3">
            📱
          </div>
          <h3 class="font-medium text-medical-neutral-900 mb-2">響應式設計</h3>
          <p class="text-sm text-medical-neutral-600">
            完全響應式設計，在桌面、平板和手機上都能完美顯示。
          </p>
        </div>
        
        <div class="bg-white rounded-lg p-4">
          <div class="w-8 h-8 bg-medical-primary-600 text-white rounded-lg flex items-center justify-center mb-3">
            🌐
          </div>
          <h3 class="font-medium text-medical-neutral-900 mb-2">多語言支援</h3>
          <p class="text-sm text-medical-neutral-600">
            支援繁體中文、英文、日文等多種語言，適合國際化應用。
          </p>
        </div>
        
        <div class="bg-white rounded-lg p-4">
          <div class="w-8 h-8 bg-medical-primary-600 text-white rounded-lg flex items-center justify-center mb-3">
            ⚡
          </div>
          <h3 class="font-medium text-medical-neutral-900 mb-2">高性能渲染</h3>
          <p class="text-sm text-medical-neutral-600">
            基於 Chart.js 和 React，提供流暢的動畫效果和高性能渲染。
          </p>
        </div>
        
        <div class="bg-white rounded-lg p-4">
          <div class="w-8 h-8 bg-medical-primary-600 text-white rounded-lg flex items-center justify-center mb-3">
            🎨
          </div>
          <h3 class="font-medium text-medical-neutral-900 mb-2">高度可定制</h3>
          <p class="text-sm text-medical-neutral-600">
            豐富的配置選項，可根據具體需求調整圖表樣式和行為。
          </p>
        </div>
        
        <div class="bg-white rounded-lg p-4">
          <div class="w-8 h-8 bg-medical-primary-600 text-white rounded-lg flex items-center justify-center mb-3">
            ♿
          </div>
          <h3 class="font-medium text-medical-neutral-900 mb-2">無障礙支援</h3>
          <p class="text-sm text-medical-neutral-600">
            遵循 WCAG 標準，支援鍵盤導航和螢幕閱讀器。
          </p>
        </div>
      </div>
    </section>

  </main>
</BaseLayout>

<style>
  .medical-chart-container {
    position: relative;
  }
  
  .medical-chart-container canvas {
    max-width: 100%;
    height: auto;
  }
  
  /* 確保圖表在小螢幕上的可讀性 */
  @media (max-width: 768px) {
    .medical-chart-container {
      font-size: 12px;
    }
  }
  
  /* 高對比模式支援 */
  @media (prefers-contrast: high) {
    .medical-chart-container {
      filter: contrast(1.2);
    }
  }
  
  /* 減少動畫偏好 */
  @media (prefers-reduced-motion: reduce) {
    .medical-chart-container canvas {
      animation: none !important;
    }
  }
</style>