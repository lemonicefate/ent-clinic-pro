---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PluginCalculator from '../../components/islands/PluginCalculator.tsx';
import type { SupportedLocale } from '../../types/calculator.js';

const locale: SupportedLocale = 'zh-TW';

const pluginMetadata = {
  id: 'lipid-management',
  namespace: 'cardiology',
  version: '1.0.0',
  name: {
    'zh-TW': '血脂管理與心血管風險計算機',
    'en': 'Lipid Management & Cardiovascular Risk Calculator',
    'ja': '脂質管理・心血管リスク計算機'
  },
  description: {
    'zh-TW': '根據2022臺灣高血壓、高血脂、糖尿病指引，評估心血管風險並提供血脂管理建議',
    'en': 'Assess cardiovascular risk and provide lipid management recommendations based on 2022 Taiwan guidelines',
    'ja': '2022年台湾ガイドラインに基づく心血管リスク評価と脂質管理推奨'
  },
};

const breadcrumbs = [
  { label: '首頁', href: '/' },
  { label: '醫療工具', href: '/tools' },
  { label: pluginMetadata.name[locale] },
];
---

<BaseLayout
  title={`${pluginMetadata.name[locale]} | Astro Clinical Platform`}
  description={pluginMetadata.description[locale]}
  locale={locale}
  medicalContent={true}
  pageType="calculator"
  breadcrumbs={breadcrumbs}
>
  <main class="container mx-auto px-4 py-8">
    <!-- 計算機標題和描述 -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900 mb-4">
        {pluginMetadata.name[locale]}
      </h1>
      <p class="text-lg text-gray-600">
        {pluginMetadata.description[locale]}
      </p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- 計算機主體 -->
      <div class="lg:col-span-2">
        <div class="bg-white rounded-lg border border-gray-200 p-6">
          <PluginCalculator
            client:load
            transition:persist="lipid-management-calculator"
            pluginId="cardiology.lipid-management"
            locale={locale}
            theme="light"
            accessibility={{
              highContrast: false,
              largeText: false,
              screenReader: false,
            }}
            className="lipid-management-calculator"
          />
        </div>
      </div>

      <!-- 側邊欄資訊 -->
      <div class="space-y-6">
        <!-- 使用說明 -->
        <div class="bg-white rounded-lg border border-gray-200 p-6">
          <h2 class="text-lg font-semibold text-gray-900 mb-4">使用說明</h2>
          <div class="space-y-3 text-sm text-gray-700">
            <div>
              <h3 class="font-medium text-gray-900 mb-1">1. 疾病狀態</h3>
              <p>勾選是否有冠心病、糖尿病、慢性腎病或家族性高膽固醇血症</p>
            </div>
            <div>
              <h3 class="font-medium text-gray-900 mb-1">2. 血脂數值</h3>
              <p>輸入最近的 LDL-C 和三酸甘油脂檢驗結果</p>
            </div>
            <div>
              <h3 class="font-medium text-gray-900 mb-1">3. 風險因子</h3>
              <p>勾選其他心血管風險因子，如年齡、吸菸、高血壓等</p>
            </div>
          </div>
        </div>

        <!-- 風險分級說明 -->
        <div class="bg-white rounded-lg border border-gray-200 p-6">
          <h2 class="text-lg font-semibold text-gray-900 mb-4">風險分級</h2>
          <div class="space-y-3 text-sm">
            <div class="flex items-start space-x-3">
              <div class="w-3 h-3 bg-red-500 rounded-full mt-1 flex-shrink-0"></div>
              <div>
                <div class="font-medium text-red-700">極高風險</div>
                <div class="text-gray-600">已有心血管疾病、糖尿病、慢性腎病或家族性高膽固醇血症</div>
              </div>
            </div>
            <div class="flex items-start space-x-3">
              <div class="w-3 h-3 bg-orange-500 rounded-full mt-1 flex-shrink-0"></div>
              <div>
                <div class="font-medium text-orange-700">中高風險</div>
                <div class="text-gray-600">具有 2 個或以上其他風險因子</div>
              </div>
            </div>
            <div class="flex items-start space-x-3">
              <div class="w-3 h-3 bg-yellow-500 rounded-full mt-1 flex-shrink-0"></div>
              <div>
                <div class="font-medium text-yellow-700">中風險</div>
                <div class="text-gray-600">具有 1 個其他風險因子</div>
              </div>
            </div>
            <div class="flex items-start space-x-3">
              <div class="w-3 h-3 bg-green-500 rounded-full mt-1 flex-shrink-0"></div>
              <div>
                <div class="font-medium text-green-700">低風險</div>
                <div class="text-gray-600">無其他風險因子</div>
              </div>
            </div>
          </div>
        </div>

        <!-- LDL-C 目標值 -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
          <h2 class="text-lg font-semibold text-blue-900 mb-4">LDL-C 目標值</h2>
          <div class="space-y-2 text-sm">
            <div class="flex justify-between">
              <span class="text-blue-700">極高風險</span>
              <span class="font-medium text-blue-900">&lt; 70 mg/dL</span>
            </div>
            <div class="flex justify-between">
              <span class="text-blue-700">中高風險</span>
              <span class="font-medium text-blue-900">&lt; 100 mg/dL</span>
            </div>
            <div class="flex justify-between">
              <span class="text-blue-700">中風險</span>
              <span class="font-medium text-blue-900">&lt; 130 mg/dL</span>
            </div>
            <div class="flex justify-between">
              <span class="text-blue-700">低風險</span>
              <span class="font-medium text-blue-900">&lt; 160 mg/dL</span>
            </div>
          </div>
        </div>

        <!-- 重要提醒 -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6">
          <h2 class="text-lg font-semibold text-yellow-800 mb-3">重要提醒</h2>
          <div class="space-y-2 text-sm text-yellow-700">
            <p>• 本計算結果僅供臨床參考，不能取代專業醫師的判斷</p>
            <p>• 用藥建議需結合患者具體情況和醫師評估</p>
            <p>• 定期追蹤血脂變化和肝功能檢查</p>
            <p>• 藥物治療應配合飲食控制和規律運動</p>
          </div>
        </div>

        <!-- 參考指引 -->
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-6">
          <h2 class="text-lg font-semibold text-gray-900 mb-3">參考指引</h2>
          <div class="text-sm text-gray-700">
            <p class="mb-2">基於以下臨床指引：</p>
            <ul class="space-y-1 text-xs">
              <li>• 2022臺灣高血壓、高血脂、糖尿病指引</li>
              <li>• 台灣心臟學會血脂異常防治建議</li>
              <li>• 中華民國血脂及動脈硬化學會指引</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </main>
</BaseLayout>