name: è‡ªå‹•åŒ–å“è³ªæª¢æŸ¥

on:
  pull_request:
    branches: [ main, master ]
    paths:
      - 'src/content/**'
      - 'public/admin/**'
      - 'src/**'
  push:
    branches: [ main, master ]
    paths:
      - 'src/content/**'
      - 'public/admin/**'
  schedule:
    # æ¯æ—¥å‡Œæ™¨ 2 é»åŸ·è¡Œå®Œæ•´æª¢æŸ¥
    - cron: '0 2 * * *'

jobs:
  # ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥
  code-quality:
    runs-on: ubuntu-latest
    name: ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥
    
    steps:
    - name: æª¢å‡ºç¨‹å¼ç¢¼
      uses: actions/checkout@v4
      
    - name: è¨­å®š Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: å®‰è£ä¾è³´
      run: npm ci
      
    - name: ESLint æª¢æŸ¥
      run: |
        if [ -f ".eslintrc.js" ] || [ -f ".eslintrc.json" ] || [ -f "eslint.config.js" ]; then
          echo "åŸ·è¡Œ ESLint æª¢æŸ¥..."
          npx eslint src/ --ext .js,.ts,.astro --format=compact || true
        else
          echo "æœªæ‰¾åˆ° ESLint é…ç½®ï¼Œè·³éæª¢æŸ¥"
        fi
        
    - name: TypeScript é¡å‹æª¢æŸ¥
      run: |
        if [ -f "tsconfig.json" ]; then
          echo "åŸ·è¡Œ TypeScript é¡å‹æª¢æŸ¥..."
          npx tsc --noEmit || true
        else
          echo "æœªæ‰¾åˆ° TypeScript é…ç½®ï¼Œè·³éæª¢æŸ¥"
        fi
        
    - name: Astro æª¢æŸ¥
      run: |
        echo "åŸ·è¡Œ Astro æª¢æŸ¥..."
        npm run astro check || true

  # å®‰å…¨æ€§æƒæ
  security-scan:
    runs-on: ubuntu-latest
    name: å®‰å…¨æ€§æƒæ
    
    steps:
    - name: æª¢å‡ºç¨‹å¼ç¢¼
      uses: actions/checkout@v4
      
    - name: è¨­å®š Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: å®‰è£ä¾è³´
      run: npm ci
      
    - name: npm audit å®‰å…¨æª¢æŸ¥
      run: |
        echo "åŸ·è¡Œ npm audit å®‰å…¨æª¢æŸ¥..."
        npm audit --audit-level=moderate || true
        
    - name: æª¢æŸ¥æ•æ„Ÿæª”æ¡ˆ
      run: |
        echo "æª¢æŸ¥æ•æ„Ÿæª”æ¡ˆå’Œè³‡è¨Š..."
        
        # æª¢æŸ¥æ˜¯å¦æœ‰æ•æ„Ÿæª”æ¡ˆ
        sensitive_files=(
          ".env"
          ".env.local"
          ".env.production"
          "config/database.yml"
          "config/secrets.yml"
          "private.key"
          "*.pem"
          "*.p12"
          "*.pfx"
        )
        
        found_sensitive=false
        for pattern in "${sensitive_files[@]}"; do
          if find . -name "$pattern" -not -path "./node_modules/*" | grep -q .; then
            echo "âš ï¸ ç™¼ç¾æ•æ„Ÿæª”æ¡ˆ: $pattern"
            found_sensitive=true
          fi
        done
        
        if [ "$found_sensitive" = false ]; then
          echo "âœ… æœªç™¼ç¾æ•æ„Ÿæª”æ¡ˆ"
        fi
        
    - name: æª¢æŸ¥ç¡¬ç·¨ç¢¼å¯†é‘°
      run: |
        echo "æª¢æŸ¥ç¡¬ç·¨ç¢¼å¯†é‘°å’Œæ•æ„Ÿè³‡è¨Š..."
        
        # æª¢æŸ¥å¸¸è¦‹çš„æ•æ„Ÿè³‡è¨Šæ¨¡å¼
        patterns=(
          "password\s*=\s*['\"][^'\"]{8,}"
          "api[_-]?key\s*=\s*['\"][^'\"]{16,}"
          "secret\s*=\s*['\"][^'\"]{16,}"
          "token\s*=\s*['\"][^'\"]{20,}"
          "AKIA[0-9A-Z]{16}"  # AWS Access Key
          "sk_live_[0-9a-zA-Z]{24}"  # Stripe Live Key
        )
        
        found_secrets=false
        for pattern in "${patterns[@]}"; do
          if grep -r -E "$pattern" src/ public/ --exclude-dir=node_modules 2>/dev/null; then
            echo "âš ï¸ å¯èƒ½ç™¼ç¾ç¡¬ç·¨ç¢¼æ•æ„Ÿè³‡è¨Š"
            found_secrets=true
          fi
        done
        
        if [ "$found_secrets" = false ]; then
          echo "âœ… æœªç™¼ç¾ç¡¬ç·¨ç¢¼æ•æ„Ÿè³‡è¨Š"
        fi

  # æ•ˆèƒ½æª¢æŸ¥
  performance-check:
    runs-on: ubuntu-latest
    name: æ•ˆèƒ½æª¢æŸ¥
    
    steps:
    - name: æª¢å‡ºç¨‹å¼ç¢¼
      uses: actions/checkout@v4
      
    - name: è¨­å®š Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: å®‰è£ä¾è³´
      run: npm ci
      
    - name: å»ºç½®å°ˆæ¡ˆ
      run: npm run build
      
    - name: åˆ†æå»ºç½®å¤§å°
      run: |
        echo "åˆ†æå»ºç½®æª”æ¡ˆå¤§å°..."
        
        if [ -d "dist" ]; then
          echo "ğŸ“Š å»ºç½®æª”æ¡ˆå¤§å°åˆ†æ:"
          
          # ç¸½å¤§å°
          total_size=$(du -sh dist | cut -f1)
          echo "ç¸½å»ºç½®å¤§å°: $total_size"
          
          # JavaScript æª”æ¡ˆ
          js_size=$(find dist -name "*.js" -exec du -ch {} + 2>/dev/null | tail -1 | cut -f1 || echo "0")
          echo "JavaScript æª”æ¡ˆ: $js_size"
          
          # CSS æª”æ¡ˆ
          css_size=$(find dist -name "*.css" -exec du -ch {} + 2>/dev/null | tail -1 | cut -f1 || echo "0")
          echo "CSS æª”æ¡ˆ: $css_size"
          
          # åœ–ç‰‡æª”æ¡ˆ
          img_size=$(find dist -name "*.jpg" -o -name "*.jpeg" -o -name "*.png" -o -name "*.gif" -o -name "*.webp" -o -name "*.svg" -exec du -ch {} + 2>/dev/null | tail -1 | cut -f1 || echo "0")
          echo "åœ–ç‰‡æª”æ¡ˆ: $img_size"
          
          # æª¢æŸ¥å¤§æª”æ¡ˆ
          echo ""
          echo "ğŸ” å¤§æ–¼ 1MB çš„æª”æ¡ˆ:"
          find dist -type f -size +1M -exec ls -lh {} \; | awk '{print $5, $9}' || echo "ç„¡å¤§æª”æ¡ˆ"
          
          # æª¢æŸ¥æœªå£“ç¸®çš„æª”æ¡ˆ
          echo ""
          echo "ğŸ—œï¸ å»ºè­°å£“ç¸®çš„æª”æ¡ˆé¡å‹:"
          find dist -name "*.js" -o -name "*.css" -o -name "*.html" | head -10 | while read file; do
            size=$(stat -f%z "$file" 2>/dev/null || stat -c%s "$file" 2>/dev/null)
            if [ "$size" -gt 10240 ]; then  # å¤§æ–¼ 10KB
              echo "  $file ($(du -h "$file" | cut -f1))"
            fi
          done
        else
          echo "âŒ å»ºç½®ç›®éŒ„ä¸å­˜åœ¨"
        fi
        
    - name: æª¢æŸ¥åœ–ç‰‡å„ªåŒ–
      run: |
        echo "æª¢æŸ¥åœ–ç‰‡å„ªåŒ–..."
        
        # æª¢æŸ¥å¤§åœ–ç‰‡æª”æ¡ˆ
        echo "ğŸ–¼ï¸ æª¢æŸ¥å¤§åœ–ç‰‡æª”æ¡ˆ (>500KB):"
        find src/content public/images -name "*.jpg" -o -name "*.jpeg" -o -name "*.png" -o -name "*.gif" 2>/dev/null | while read file; do
          if [ -f "$file" ]; then
            size=$(stat -f%z "$file" 2>/dev/null || stat -c%s "$file" 2>/dev/null)
            if [ "$size" -gt 512000 ]; then  # å¤§æ–¼ 500KB
              size_mb=$(echo "scale=2; $size/1024/1024" | bc -l 2>/dev/null || echo "unknown")
              echo "  âš ï¸ $file (${size_mb}MB)"
            fi
          fi
        done
        
        # æª¢æŸ¥æ˜¯å¦ä½¿ç”¨ç¾ä»£åœ–ç‰‡æ ¼å¼
        echo ""
        echo "ğŸ“¸ åœ–ç‰‡æ ¼å¼å»ºè­°:"
        old_format_count=$(find src/content public/images -name "*.jpg" -o -name "*.jpeg" -o -name "*.png" 2>/dev/null | wc -l)
        webp_count=$(find src/content public/images -name "*.webp" 2>/dev/null | wc -l)
        avif_count=$(find src/content public/images -name "*.avif" 2>/dev/null | wc -l)
        
        echo "  å‚³çµ±æ ¼å¼ (JPG/PNG): $old_format_count å€‹æª”æ¡ˆ"
        echo "  WebP æ ¼å¼: $webp_count å€‹æª”æ¡ˆ"
        echo "  AVIF æ ¼å¼: $avif_count å€‹æª”æ¡ˆ"
        
        if [ "$old_format_count" -gt 0 ] && [ "$webp_count" -eq 0 ]; then
          echo "  ğŸ’¡ å»ºè­°ä½¿ç”¨ WebP æ ¼å¼ä»¥æå‡è¼‰å…¥é€Ÿåº¦"
        fi

  # å…§å®¹å“è³ªç›£æ§
  content-quality-monitoring:
    runs-on: ubuntu-latest
    name: å…§å®¹å“è³ªç›£æ§
    if: github.event_name == 'schedule'
    
    steps:
    - name: æª¢å‡ºç¨‹å¼ç¢¼
      uses: actions/checkout@v4
      
    - name: è¨­å®š Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: å…§å®¹çµ±è¨ˆåˆ†æ
      run: |
        echo "åŸ·è¡Œå…§å®¹å“è³ªç›£æ§..."
        
        cat > content-monitoring.js << 'EOF'
        const fs = require('fs');
        const path = require('path');
        const yaml = require('js-yaml');
        
        function generateContentReport() {
          const educationDir = 'src/content/education';
          
          if (!fs.existsSync(educationDir)) {
            console.log('æ•™è‚²å…§å®¹ç›®éŒ„ä¸å­˜åœ¨');
            return;
          }
          
          const files = fs.readdirSync(educationDir, { recursive: true })
            .filter(file => file.endsWith('.md'))
            .map(file => path.join(educationDir, file));
          
          const stats = {
            totalArticles: files.length,
            bySpecialty: {},
            byStatus: {},
            byAuthor: {},
            avgWordCount: 0,
            recentUpdates: [],
            qualityIssues: []
          };
          
          let totalWords = 0;
          const now = new Date();
          const oneWeekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
          
          for (const file of files) {
            try {
              const content = fs.readFileSync(file, 'utf8');
              const frontmatterMatch = content.match(/^---\n([\s\S]*?)\n---/);
              
              if (!frontmatterMatch) continue;
              
              const frontmatter = yaml.load(frontmatterMatch[1]);
              const bodyContent = content.replace(/^---\n[\s\S]*?\n---\n/, '');
              const wordCount = bodyContent.split(/\s+/).length;
              
              totalWords += wordCount;
              
              // çµ±è¨ˆå°ˆç§‘åˆ†å¸ƒ
              const specialty = frontmatter.specialty || 'unknown';
              stats.bySpecialty[specialty] = (stats.bySpecialty[specialty] || 0) + 1;
              
              // çµ±è¨ˆç‹€æ…‹åˆ†å¸ƒ
              const status = frontmatter.status || 'unknown';
              stats.byStatus[status] = (stats.byStatus[status] || 0) + 1;
              
              // çµ±è¨ˆä½œè€…åˆ†å¸ƒ
              const author = frontmatter.author || 'unknown';
              stats.byAuthor[author] = (stats.byAuthor[author] || 0) + 1;
              
              // æª¢æŸ¥æœ€è¿‘æ›´æ–°
              const publishDate = new Date(frontmatter.publishDate);
              if (publishDate > oneWeekAgo) {
                stats.recentUpdates.push({
                  file: file,
                  title: frontmatter.title,
                  date: publishDate.toISOString().split('T')[0]
                });
              }
              
              // å“è³ªå•é¡Œæª¢æŸ¥
              if (wordCount < 200) {
                stats.qualityIssues.push({
                  file: file,
                  issue: `å…§å®¹éçŸ­ (${wordCount} å­—)`,
                  severity: 'warning'
                });
              }
              
              if (!frontmatter.description || frontmatter.description.length < 50) {
                stats.qualityIssues.push({
                  file: file,
                  issue: 'æè¿°éçŸ­æˆ–ç¼ºå¤±',
                  severity: 'warning'
                });
              }
              
              if (!frontmatter.tags || frontmatter.tags.length === 0) {
                stats.qualityIssues.push({
                  file: file,
                  issue: 'ç¼ºå°‘æ¨™ç±¤',
                  severity: 'info'
                });
              }
              
            } catch (error) {
              stats.qualityIssues.push({
                file: file,
                issue: `æª”æ¡ˆè§£æéŒ¯èª¤: ${error.message}`,
                severity: 'error'
              });
            }
          }
          
          stats.avgWordCount = Math.round(totalWords / files.length);
          
          // ç”Ÿæˆå ±å‘Š
          console.log('ğŸ“Š å…§å®¹å“è³ªç›£æ§å ±å‘Š');
          console.log('='.repeat(50));
          console.log(`ç¸½æ–‡ç« æ•¸: ${stats.totalArticles}`);
          console.log(`å¹³å‡å­—æ•¸: ${stats.avgWordCount}`);
          console.log('');
          
          console.log('ğŸ“ˆ å°ˆç§‘åˆ†å¸ƒ:');
          Object.entries(stats.bySpecialty)
            .sort(([,a], [,b]) => b - a)
            .forEach(([specialty, count]) => {
              console.log(`  ${specialty}: ${count} ç¯‡`);
            });
          console.log('');
          
          console.log('ğŸ“‹ ç‹€æ…‹åˆ†å¸ƒ:');
          Object.entries(stats.byStatus)
            .forEach(([status, count]) => {
              console.log(`  ${status}: ${count} ç¯‡`);
            });
          console.log('');
          
          console.log('ğŸ‘¥ ä½œè€…åˆ†å¸ƒ:');
          Object.entries(stats.byAuthor)
            .sort(([,a], [,b]) => b - a)
            .slice(0, 10)
            .forEach(([author, count]) => {
              console.log(`  ${author}: ${count} ç¯‡`);
            });
          console.log('');
          
          console.log('ğŸ†• æœ€è¿‘æ›´æ–° (7å¤©å…§):');
          stats.recentUpdates
            .sort((a, b) => new Date(b.date) - new Date(a.date))
            .slice(0, 10)
            .forEach(update => {
              console.log(`  ${update.date}: ${update.title}`);
            });
          console.log('');
          
          console.log('âš ï¸ å“è³ªå•é¡Œ:');
          const errorCount = stats.qualityIssues.filter(i => i.severity === 'error').length;
          const warningCount = stats.qualityIssues.filter(i => i.severity === 'warning').length;
          const infoCount = stats.qualityIssues.filter(i => i.severity === 'info').length;
          
          console.log(`  éŒ¯èª¤: ${errorCount} å€‹`);
          console.log(`  è­¦å‘Š: ${warningCount} å€‹`);
          console.log(`  è³‡è¨Š: ${infoCount} å€‹`);
          
          if (stats.qualityIssues.length > 0) {
            console.log('');
            console.log('è©³ç´°å•é¡Œåˆ—è¡¨:');
            stats.qualityIssues.slice(0, 20).forEach(issue => {
              const icon = issue.severity === 'error' ? 'âŒ' : 
                          issue.severity === 'warning' ? 'âš ï¸' : 'â„¹ï¸';
              console.log(`  ${icon} ${issue.file}: ${issue.issue}`);
            });
            
            if (stats.qualityIssues.length > 20) {
              console.log(`  ... é‚„æœ‰ ${stats.qualityIssues.length - 20} å€‹å•é¡Œ`);
            }
          }
          
          // ç”Ÿæˆ JSON å ±å‘Š
          const report = {
            generatedAt: new Date().toISOString(),
            stats: stats
          };
          
          fs.writeFileSync('content-quality-report.json', JSON.stringify(report, null, 2));
          console.log('\nğŸ“„ è©³ç´°å ±å‘Šå·²å„²å­˜è‡³ content-quality-report.json');
        }
        
        generateContentReport();
        EOF
        
        node content-monitoring.js
        
    - name: ä¸Šå‚³å“è³ªå ±å‘Š
      uses: actions/upload-artifact@v4
      with:
        name: content-quality-report
        path: content-quality-report.json
        retention-days: 30

  # ä¾è³´æ›´æ–°æª¢æŸ¥
  dependency-check:
    runs-on: ubuntu-latest
    name: ä¾è³´æ›´æ–°æª¢æŸ¥
    if: github.event_name == 'schedule'
    
    steps:
    - name: æª¢å‡ºç¨‹å¼ç¢¼
      uses: actions/checkout@v4
      
    - name: è¨­å®š Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: æª¢æŸ¥éæœŸä¾è³´
      run: |
        echo "æª¢æŸ¥éæœŸä¾è³´..."
        
        # æª¢æŸ¥éæœŸçš„ npm å¥—ä»¶
        echo "ğŸ“¦ æª¢æŸ¥ npm å¥—ä»¶æ›´æ–°:"
        npm outdated || true
        
        echo ""
        echo "ğŸ”’ æª¢æŸ¥å®‰å…¨æ¼æ´:"
        npm audit || true
        
        echo ""
        echo "ğŸ“Š ä¾è³´åˆ†æ:"
        
        # åˆ†æ package.json
        if [ -f "package.json" ]; then
          deps_count=$(jq '.dependencies | length' package.json 2>/dev/null || echo "0")
          dev_deps_count=$(jq '.devDependencies | length' package.json 2>/dev/null || echo "0")
          
          echo "  ç”Ÿç”¢ä¾è³´: $deps_count å€‹"
          echo "  é–‹ç™¼ä¾è³´: $dev_deps_count å€‹"
          
          # æª¢æŸ¥å¤§å‹ä¾è³´
          echo ""
          echo "ğŸ“ˆ å¥—ä»¶å¤§å°åˆ†æ:"
          if command -v npx >/dev/null 2>&1; then
            npx cost-of-modules --no-install 2>/dev/null | head -10 || echo "  ç„¡æ³•åˆ†æå¥—ä»¶å¤§å°"
          fi
        fi

  # ç¶œåˆå ±å‘Š
  generate-quality-report:
    runs-on: ubuntu-latest
    name: ç”Ÿæˆå“è³ªå ±å‘Š
    needs: [code-quality, security-scan, performance-check, content-quality-monitoring, dependency-check]
    if: always()
    
    steps:
    - name: æª¢å‡ºç¨‹å¼ç¢¼
      uses: actions/checkout@v4
      
    - name: ç”Ÿæˆç¶œåˆå“è³ªå ±å‘Š
      run: |
        echo "ç”Ÿæˆç¶œåˆå“è³ªå ±å‘Š..."
        
        cat > quality-report.md << 'EOF'
        # è‡ªå‹•åŒ–å“è³ªæª¢æŸ¥å ±å‘Š
        
        **ç”Ÿæˆæ™‚é–“**: $(date)
        **æäº¤**: ${{ github.sha }}
        **åˆ†æ”¯**: ${{ github.ref_name }}
        **è§¸ç™¼äº‹ä»¶**: ${{ github.event_name }}
        
        ## æª¢æŸ¥çµæœæ‘˜è¦
        
        | æª¢æŸ¥é …ç›® | ç‹€æ…‹ | èªªæ˜ |
        |---------|------|------|
        | ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥ | ${{ needs.code-quality.result == 'success' && 'âœ… é€šé' || needs.code-quality.result == 'skipped' && 'â­ï¸ è·³é' || 'âŒ å¤±æ•—' }} | ESLint, TypeScript, Astro æª¢æŸ¥ |
        | å®‰å…¨æ€§æƒæ | ${{ needs.security-scan.result == 'success' && 'âœ… é€šé' || needs.security-scan.result == 'skipped' && 'â­ï¸ è·³é' || 'âŒ å¤±æ•—' }} | ä¾è³´æ¼æ´ã€æ•æ„Ÿè³‡è¨Šæª¢æŸ¥ |
        | æ•ˆèƒ½æª¢æŸ¥ | ${{ needs.performance-check.result == 'success' && 'âœ… é€šé' || needs.performance-check.result == 'skipped' && 'â­ï¸ è·³é' || 'âŒ å¤±æ•—' }} | å»ºç½®å¤§å°ã€åœ–ç‰‡å„ªåŒ–åˆ†æ |
        | å…§å®¹å“è³ªç›£æ§ | ${{ needs.content-quality-monitoring.result == 'success' && 'âœ… é€šé' || needs.content-quality-monitoring.result == 'skipped' && 'â­ï¸ è·³é' || 'âŒ å¤±æ•—' }} | å…§å®¹çµ±è¨ˆã€å“è³ªå•é¡Œæª¢æŸ¥ |
        | ä¾è³´æ›´æ–°æª¢æŸ¥ | ${{ needs.dependency-check.result == 'success' && 'âœ… é€šé' || needs.dependency-check.result == 'skipped' && 'â­ï¸ è·³é' || 'âŒ å¤±æ•—' }} | éæœŸä¾è³´ã€å®‰å…¨æ¼æ´æª¢æŸ¥ |
        
        ## å“è³ªæŒ‡æ¨™
        
        ### ç¨‹å¼ç¢¼å“è³ª
        - **ESLint**: æª¢æŸ¥ JavaScript/TypeScript ç¨‹å¼ç¢¼è¦ç¯„
        - **TypeScript**: é¡å‹å®‰å…¨æª¢æŸ¥
        - **Astro**: æ¡†æ¶ç‰¹å®šæª¢æŸ¥
        
        ### å®‰å…¨æ€§
        - **ä¾è³´æƒæ**: æª¢æŸ¥å·²çŸ¥å®‰å…¨æ¼æ´
        - **æ•æ„Ÿè³‡è¨Š**: é˜²æ­¢å¯†é‘°æ´©éœ²
        - **æª”æ¡ˆå®‰å…¨**: æª¢æŸ¥æ•æ„Ÿæª”æ¡ˆ
        
        ### æ•ˆèƒ½
        - **å»ºç½®å¤§å°**: ç›£æ§è¼¸å‡ºæª”æ¡ˆå¤§å°
        - **åœ–ç‰‡å„ªåŒ–**: æª¢æŸ¥åœ–ç‰‡æ ¼å¼å’Œå¤§å°
        - **è³‡æºåˆ†æ**: è­˜åˆ¥æ•ˆèƒ½ç“¶é ¸
        
        ### å…§å®¹å“è³ª
        - **å…§å®¹çµ±è¨ˆ**: æ–‡ç« æ•¸é‡ã€å­—æ•¸åˆ†æ
        - **å“è³ªæª¢æŸ¥**: çµæ§‹ã€æ ¼å¼ã€å®Œæ•´æ€§
        - **æ›´æ–°è¿½è¹¤**: æœ€è¿‘ä¿®æ”¹å…§å®¹
        
        ## å»ºè­°æ”¹å–„äº‹é …
        
        æ ¹æ“šæª¢æŸ¥çµæœï¼Œå»ºè­°é—œæ³¨ä»¥ä¸‹æ–¹é¢ï¼š
        
        1. **ç¨‹å¼ç¢¼å“è³ª**: ä¿®å¾© ESLint å’Œ TypeScript éŒ¯èª¤
        2. **å®‰å…¨æ€§**: æ›´æ–°æœ‰æ¼æ´çš„ä¾è³´å¥—ä»¶
        3. **æ•ˆèƒ½**: å„ªåŒ–å¤§æª”æ¡ˆå’Œåœ–ç‰‡
        4. **å…§å®¹**: æ”¹å–„å“è³ªå•é¡Œè¼ƒå¤šçš„æ–‡ç« 
        
        ## è‡ªå‹•åŒ–æ”¹å–„
        
        ç³»çµ±æœƒè‡ªå‹•åŸ·è¡Œä»¥ä¸‹æ”¹å–„æªæ–½ï¼š
        - å®šæœŸæƒæå®‰å…¨æ¼æ´
        - ç›£æ§å…§å®¹å“è³ªè¶¨å‹¢
        - è¿½è¹¤æ•ˆèƒ½æŒ‡æ¨™è®ŠåŒ–
        - ç”Ÿæˆæ”¹å–„å»ºè­°
        
        ---
        
        *æ­¤å ±å‘Šç”± GitHub Actions è‡ªå‹•ç”Ÿæˆï¼Œæ¯æ—¥æ›´æ–°*
        EOF
        
        echo "å“è³ªå ±å‘Šå·²ç”Ÿæˆ"
        
    - name: ä¸Šå‚³å“è³ªå ±å‘Š
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: quality-report
        path: quality-report.md
        retention-days: 30
        
    - name: é€šçŸ¥å“è³ªç‹€æ…‹
      if: failure()
      run: |
        echo "âš ï¸ å“è³ªæª¢æŸ¥ç™¼ç¾å•é¡Œï¼Œè«‹æŸ¥çœ‹è©³ç´°å ±å‘Š"
        echo "ğŸ“‹ å¯åœ¨ Actions é é¢ä¸‹è¼‰å®Œæ•´å ±å‘Š"